def ProfileMostProbableKmer(text, k, profile):
    t = len(text)
    min = -1
    mostProbableKmer = ""
    # loop through every k-mer in text
    for i in range(t-k+1):
        kmer = text[i:i+k]
        pr = Pr(kmer, profile)
        if pr > min:
            mostProbableKmer = kmer
            min = pr
    return mostProbableKmer

# Input:  String Text and profile matrix Profile
# Output: Pr(Text, Profile)
def Pr(Text, Profile):
    p = 1
    for i in range(len(Text)):
        symbol = Text[i]
        p *= Profile[symbol][i]
    return p


#text = 'TAGTCCCCATGGCGTTAGTATAATACTAGACCGTAGTTTTCGGTGCTAATACGAACAGTAAGCAATATGAAGTGAGCGCTTGCTCGAAGACGCAAGCAAGTCTATGCGGTGTACATGCGCGCGATGTCGCCCGCGGTGCCTTCACTGTGAACTCTTGAACACGCCCGTCCATATATGCCGTTGATTCCGAGAAGAGTCCCCTACTGAGGAAGAGCCCCTCTACTTTCTGGCCAACTGTTAGAGAGTGGGCCCCAGGTGGCGGTAAGCAATTTGTCTCGGAGTGCTTTTATAAACAAAAGGCCAGTGAGCAACCGTCCTCTTACCCTCTCCACATTGATACCTGCCATAAGTCAGGGCGCGTTGGACCTATCACTACCTTGAGCAATCAAGGCATCAAAGTAAACGAAATGAGCCGCACGCCGTCTAGAGAGAATAAACAGGGGCTACATAAGTATGGCCATCTTCTGGTGTTACCATAAAGGAAGCGGGACCAGCTCCAGCAGCCTCAAGTTGCGACTACTGGTAGTCCCAGTGTTTAGGAGAGAGCACGCTGATTGGTAACTGTTTACGGGCCGAAGATGGTCTCACCCCCCCAGTTGACCTCACTGCTTGTCAACACCGAGCTCTTGCCGAATTTTTTTCTAGAAATGGAGCAACAGACACAGACGAACTATGTCTAATGACTTAATCAAGGCCTAGGTGCTCACTATTATTAACTTAGCATTCTGAGCATACGCGGGCGCGTTACCATCGCACACAGCTGAGCAGGTTTTTCCCAGAGTCGTTTAGAGGCGTTACACGGGTTTCCGCTTTTCCGGAGAGGCTGCTGGCGCGTTACTGCGTGTTGGATACGCAATCACATCACATCTGAAGTATAAGGAATCTATGCGAGCAAAACGGAAGAGTCGCTAAGTGCGCCGCACTCTGCTGATAGGCTCGCTCTAGAGAGAATACATCAAGTACAAGTTGGCTGCGCGTGCGCCACTCTTCTAGTGATTAC'
#k = 13
#profile = {
#    'A': [0.237, 0.263, 0.224, 0.329, 0.224, 0.329, 0.224, 0.303, 0.184, 0.276, 0.197, 0.316, 0.276],
#    'C': [0.25, 0.197, 0.237, 0.263, 0.276, 0.158, 0.329, 0.171, 0.289, 0.224, 0.25, 0.132, 0.158],
#    'G': [0.25, 0.276, 0.263, 0.263, 0.303, 0.316, 0.158, 0.263, 0.289, 0.263, 0.263, 0.276, 0.25],
#    'T': [0.263, 0.263, 0.276, 0.145, 0.197, 0.197, 0.289, 0.263, 0.237, 0.237, 0.289, 0.276, 0.316] }


#print(ProfileMostProbableKmer(text, k, profile))
